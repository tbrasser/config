# lovelace_gen
type: custom:vertical-stack-in-card
card_mod:
  style: |
    ha-card {
      height: 68px;
      {{ "{%" }} set entity = 'light.{{ room }}_lights' {{ "%}" }}
      {{ "{%" }} if is_state(entity, 'on') {{ "%}" }}
      {{ "{%" }} set r = state_attr(entity, 'rgb_color')[0] {{ "%}" }}
      {{ "{%" }} set g = state_attr(entity, 'rgb_color')[1] {{ "%}" }}
      {{ "{%" }} set b = state_attr(entity, 'rgb_color')[2] {{ "%}" }}
      background: rgba({{ "{{" }}r{{ "}}" }}, {{ "{{" }}g{{ "}}" }}, {{ "{{" }}b{{ "}}" }},0.1);
      {{ "{%" }} else {{ "%}" }}
      background: none;
      {{ "{%" }} endif {{ "%}" }}
    }
cards:
  - type: custom:mushroom-template-card
    primary: "{{ room|capitalize }}"
    icon: "{{ icon }}"
    entity: "light.{{ room }}_lights"
    icon_color: '{{ "{{" }} "{{ color }}" if is_state(entity, "on") else "disabled" {{ "}}" }}'
    fill_container: true
    layout: horizontal
    card_mod:
      class: invisible
      style: |
        :host {
          --mush-icon-symbol-size: 1em;
        }
        ha-card: {
          margin-top: -16px !important;
        }
        .:
          ha-card {
            top: -66px;
          }
          mushroom-shape-icon {
            --shape-color: none !important;
          }
    double_tap_action:
      action: toggle
    hold_action:
      action: fire-dom-event
      browser_mod:
        service: browser_mod.popup
        data: !include
          - popups/room.yaml
          - room: "{{ room }}"
    tap_action:
      action: fire-dom-event
      browser_mod:
        service: browser_mod.navigate
        data:
          path: "{{ room }}"
  - type: custom:mushroom-chips-card
    alignment: end
    card_mod:
      class: invisible
      style: |
        :host {
          position: relative;
          bottom: 32px;
        }
        ha-card {
          --chip-background: none;
          backdrop-filter: unset;
          --chip-border-width: 0;
          --chip-spacing: 0;
          --chip-box-shadow: none;
          --chip-height: 32px;
          z-index: 666;
        }
    chips:
      - type: conditional
        conditions:
          - entity: sensor.winston_room
            state: {{ room }}
          - entity: vacuum.winston
            state_not: docked
        chip:
          type: entity
          entity: vacuum.winston
          icon: mdi:robot-vacuum
          content_info: none
          tap_action:
            action: navigate
            navigation_path: /lovelace/winston
          card_mod:
            style: |
              ha-card {
                backdrop-filter: unset;
                -webkit-backdrop-filter: unset;
              }
      - type: conditional
        conditions:
          - entity: {{ media }}
            state_not: "off"
          - entity: {{ media }}
            state_not: idle
        chip:
          type: entity
          entity: {{ media }}
          content_info: none
          tap_action:
            action: more-info
          card_mod:
            style: |
              ha-card {
                backdrop-filter: unset;
                -webkit-backdrop-filter: unset;
              }
      - type: conditional
        conditions:
          - entity: binary_sensor.deuren_{{ room }}
            state: "open"
        chip:
          type: entity
          entity: binary_sensor.deuren_{{ room }}
          content_info: none
          tap_action:
            action: more-info
          card_mod:
            style: |
              ha-card {
                backdrop-filter: unset;
                -webkit-backdrop-filter: unset;
              }
      - type: conditional
        conditions:
          - entity: binary_sensor.beweging_{{ room }}
            state: "on"
        chip:
          type: entity
          entity: binary_sensor.beweging_{{ room }}
          content_info: none
          tap_action:
            action: more-info
          card_mod:
            style: |
              ha-card {
                backdrop-filter: unset;
                -webkit-backdrop-filter: unset;
              }
