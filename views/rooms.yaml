# lovelace_gen
{% for room in _global.rooms %}
- type: panel
  path: {{ room.name }}
  subview: true
  cards:
    - type: custom:mod-card
      card_mod:
        class: invisible
        style: |
          ha-card {
            border-radius: 0px !important;
            border-width: 0px !important;
            {{ "{%" }} if state_attr( "{{ room.media }}", "entity_picture" ) != none {{ "%}" }}
            background: center / cover no-repeat fixed url( '{{ "{{" }} state_attr( "{{ room.media }}", "entity_picture" ) {{ "}}" }}' );
            {{ "{%" }} endif {{ "%}" }}
          }
      card:
        type: custom:state-switch
        entity: mediaquery
        states:
          '(orientation: landscape)':
            type: vertical-stack
            cards:
              - !include
                - .cards/sticky.yaml
                - view: {{ room.name }}
                  position: both
              - type: custom:layout-card
                layout_type: custom:grid-layout
                layout: !include .cards/layout.yaml
                cards:
                  {% if "media" in room %}
                  - !include
                    - .cards/timer_active.yaml
                    - timer: {{ room.name }}_1
                  - !include
                    - .cards/timer_active.yaml
                    - timer: {{ room.name }}_2
                  - !include
                    - .cards/media_player_active.yaml
                    - entity: {{ room.media }}
                  - !include
                    - .cards/media_player_inactive.yaml
                    - entity: {{ room.media }}
                  {% endif %}
                  - type: conditional
                    view_layout:
                      grid-column-end: span 2
                      grid-row-end: span 126
                    conditions:
                      - entity: sensor.winston_room
                        state: {{ room.name }}
                      - entity: vacuum.winston
                        state_not: docked
                    card:
                      type: tile
                      entity: vacuum.winston
                      features:
                        - type: vacuum-commands
                          commands: [start_pause, stop, clean_spot, locate, return_home]
                  {% if "lights" in room %}
                  {% for light in room.lights %}
                  - !include
                    - .cards/light_active.yaml
                    - entity: {{ light.entity }}
                      name: {{ light.name|capitalize }}
                      type: {{ light.type }}
                      media: {{ room.media }}
                      view: {{ room.name }}
                      orientation: landscape
                  - !include
                    - .cards/light_inactive.yaml
                    - entity: {{ light.entity }}
                      name: {{ light.name|capitalize }}
                      type: {{ light.type }}
                      media: {{ room.media }}
                      view: {{ room.name }}
                      orientation: landscape
                  {% endfor %}
                  {% endif %}
                  {% if "devices" in room %}
                  {% for device in room.devices %}
                  - {% for key in device|list %}
                    {{ key }}: {{ device[key]|tojson }}
                    {% endfor %}
                  {% endfor %}
                  {% endif %}
                  {% if "plants" in room %}
                  {% for plant in room.plants %}
                  - !include
                    - .cards/plant.yaml
                    - entity: {{ plant.entity }}
                      battery: {{ plant.battery }}
                      media: {{ room.media }}
                      room: {{ room.name }}
                      view: {{ room.name }}
                  {% endfor %}
                  {% endif %}
          '(orientation: portrait)':
            type: vertical-stack
            cards:
              - !include
                - .cards/sticky.yaml
                - view: {{ room.name }}
                  position: header
              - type: custom:layout-card
                layout_type: custom:grid-layout
                layout: !include .cards/layout.yaml
                cards:
                  {% if "media" in room %}
                  - !include
                    - .cards/timer_active.yaml
                    - timer: {{ room.name }}_1
                  - !include
                    - .cards/timer_active.yaml
                    - timer: {{ room.name }}_2
                  - !include
                    - .cards/media_player_active.yaml
                    - entity: {{ room.media }}
                  - !include
                    - .cards/media_player_inactive.yaml
                    - entity: {{ room.media }}
                  {% endif %}
                  {% if "lights" in room %}
                  {% for light in room.lights %}
                  - !include
                    - .cards/light_active.yaml
                    - entity: {{ light.entity }}
                      name: {{ light.name|capitalize }}
                      type: {{ light.type }}
                      media: {{ room.media }}
                      view: {{ room.name }}
                      orientation: portrait
                  - !include
                    - .cards/light_inactive.yaml
                    - entity: {{ light.entity }}
                      name: {{ light.name|capitalize }}
                      type: {{ light.type }}
                      media: {{ room.media }}
                      view: {{ room.name }}
                      orientation: portrait
                  {% endfor %}
                  {% endif %}
                  {% if "devices" in room %}
                  {% for device in room.devices %}
                  - {% for key in device|list %}
                    {{ key }}: {{ device[key]|tojson }}
                    {% endfor %}
                  {% endfor %}
                  {% endif %}
                  {% if "plants" in room %}
                  {% for plant in room.plants %}
                  - !include
                    - .cards/plant.yaml
                    - entity: {{ plant.entity }}
                      battery: {{ plant.battery }}
                      media: {{ room.media }}
                      room: {{ room.name }}
                      view: {{ room.name }}
                  {% endfor %}
                  {% endif %}
              - !include
                - .cards/sticky.yaml
                - view: {{ room.name }}
                  position: footer
{% endfor %}